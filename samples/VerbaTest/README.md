# Пример с VerbaTest

Работающий пример безостановочной обработки файлов, подкидываемых 
во входные папки. В результате получаются файлы в выходной папке, 
а исходные перемещаются в подпапки *ok* или *bad*, очищая вход в 
любом случае.

## VerbaTest

Эти скрипты используют тестовую утилиту, собранную с помощью 
системных компиляторов *csc* из состава установленных библиотек .NET.
Примеры этого есть в папке [test](..\..\test):

  * ```csc.cmd``` - для .NET 3.5
  * ```csc4.cmd``` - для .NET 4+
                                                                              *
Для сборки требуются классы *Wbotho*, *Posh*, *Wftesto*, *VerbaTest*.

## Общий справочник

Для скриптов создается общий справочник, для которого не требуется 
переставлять ключи для каждой операции. 
Подробнее о справочнике в [pub](..\..\pub).

## Настройки

Все настройки в файле *init.cmd*: идентификаторы ключей, путь к общему 
справочнику (*C:\Pub*), идентификаторы адресатов (*TOXXX*). 
Файл вызывается первым использующим скриптом.

## Использование

    encrypt in\* out\ XXXXSSSSSS XXXX [ext]
    decrypt in\* out\ XXXX [ext]

    sign in\* out\ XXXXSSSSSSYY
    verify in\* out\
    unsign in\* out\

Если указано *ext*, то расширение файла после обработки меняется на 
указанное.

В случае успешной обработки исходные файлы перемещаются в создаваемую 
папку *in\ok\YYYYMMDD*, в случае любой ошибки - в *in\bad\YYYYMMDD*. 
Это позволяет постоянно подкидывать новые файлы для обработки и не 
прерывать работу при возникновении сбоев. 
Ход обработки логируется в *logs\YYYYMMDD.log*. Можно указать два лога. 

## Самотестирование

В файле *_test.cmd* пример использования, где создается папка *test* с 
тестовым файлом, а затем он подписывается в создаваемую папку *s*, затем 
зашифровывается в *e*, расшифровывается в *d*, проверяется подпись в *v* и 
снимается в *u*. Разумеется, предварительно надо задать идентификаторы в 
*init.cmd*, иметь подготовленный общий справочник в *C:\Pub* и все эти 
ключи, загруженные в память драйвера *asrkeyw* (ключевые носители после 
этого не требуются).
