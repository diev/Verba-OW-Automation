# Пример генерации утилит с помощью одного только CMD

Этот скрипт генерирует набор исполняемых утилит в создаваемой
папке *bin* с помощью системного компилятора *csc* из состава
установленных библиотек .NET.
Примеры этого есть в папке [test](../../test):

* ```csc.cmd``` - для .NET 3.5
* ```csc4.cmd``` - для .NET 4+

Для сборки не требуется ничего больше - даже не нужно полного
исходного кода [Verba.cs](../../verba/Verba.cs) - весь
необходимый для генерации утилит минимум кода содержится в
тексте самого *make.cmd* как скрипта - никаких подозрительных
побочных файлов.

## Общий справочник

Для выполнения данных утилит нужен общий справочник, для которого
не требуется переставлять ключи для каждой операции.
Подробнее о таком справочнике в [pub](../../pub).

## Настройки

В постоянные настройки здесь можно вынести, пожалуй, только путь к
общему справочнику (*C:\Pub*). Можно еще и идентификатор своей подписи
(ключ КА), но тогда при его смене надо не забыть перегенерировать
утилиту *sign*.

Эти настройки можно указать в начале файла *make.cmd* в переменных
*set*, а затем использовать через подстановки в *%%* далее по тексту.

## Использование

    encrypt in\[*] out\ XXXXSSSSSS XXXX[SSSSSS] [ext]
    decrypt in\[*] out\ XXXX[SSSSSS] XXXXSSSSSS [ext]

    sign    in\[*] out\ [XXXXSSSSSSYY]
    verify  in\[*] out\
    unsign  in\[*] out\

Обязательные параметры:

* *in\\* - папка исходных файлов.
* *\** - фильтр исходных файлов (опционально).
* *out\\* - папка назначения для успешно обработанных файлов.
* *XXXSSSSSS* - полные идентификаторы ключей шифрования отправителя и
получателя (если серия совпадает, что практически всегда, то второй раз
ее можно не указывать). Если при шифровании указан полный идентификатор
КА, то будет использовано 10 символов ключа шифрования.

Опциональные параметры:

* *XXXSSSSSSYY* - идентификатор ключа КА (по умолчанию - своей
подписи, указанной в *make.cmd* при генерации).
* *ext* - новое расширение обработанных файлов, если его надо
изменить - например, *VRB* - для зашифрованных файлов.

## Примечания

Для расшифровывания обратно своих отправленных файлов надо указать
первоначальный ключ получателя и свой ключ (в таком порядке).

Утилиты не возвращают никакого кода возврата во избежание необходимости
контроля встраивания. Весь результат - появление или отсутствие файла
в папке назначения, обработанного штатными функциями ядра.
